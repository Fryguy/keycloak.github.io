<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book Server Developer Guide -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Model Interfaces | Server Developer Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-splitter/splitter.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../topics/user-storage/packaging.html" />
    
    
    <link rel="prev" href="../../topics/user-storage/provider-capability-interfaces.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <div class="book"
        data-level="9.3"
        data-chapter-title="Model Interfaces"
        data-filepath="topics/user-storage/model-interfaces.adoc"
        data-basepath="../.."
        data-revision="Wed Feb 08 2017 07:51:10 GMT+0100 (CET)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="topics/preface.html">
            
                
                    <a href="../../topics/preface.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Preface
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="topics/admin-rest-api.html">
            
                
                    <a href="../../topics/admin-rest-api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Admin REST API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="topics/themes.html">
            
                
                    <a href="../../topics/themes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Themes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="topics/custom-attributes.html">
            
                
                    <a href="../../topics/custom-attributes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Custom User Attributes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="topics/providers.html">
            
                
                    <a href="../../topics/providers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Service Provider Interfaces (SPI)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="topics/extensions.html">
            
                
                    <a href="../../topics/extensions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Extending Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="topics/auth-spi.html">
            
                
                    <a href="../../topics/auth-spi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Authentication SPI
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="topics/events.html">
            
                
                    <a href="../../topics/events.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Event Listener SPI
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="topics/user-storage.html">
            
                
                    <a href="../../topics/user-storage.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        User Storage SPI
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="topics/user-storage/provider-interfaces.html">
            
                
                    <a href="../../topics/user-storage/provider-interfaces.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Provider Interfaces
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="topics/user-storage/provider-capability-interfaces.html">
            
                
                    <a href="../../topics/user-storage/provider-capability-interfaces.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Provider Capability Interfaces
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="9.3" data-path="topics/user-storage/model-interfaces.html">
            
                
                    <a href="../../topics/user-storage/model-interfaces.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.3.</b>
                        
                        Model Interfaces
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="topics/user-storage/packaging.html">
            
                
                    <a href="../../topics/user-storage/packaging.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.4.</b>
                        
                        Packaging and Deployment
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="topics/user-storage/simple-example.html">
            
                
                    <a href="../../topics/user-storage/simple-example.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.5.</b>
                        
                        Simple Read-Only, Lookup Example
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="topics/user-storage/configuration.html">
            
                
                    <a href="../../topics/user-storage/configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.6.</b>
                        
                        Configuration Techniques
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="topics/user-storage/registration-query.html">
            
                
                    <a href="../../topics/user-storage/registration-query.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.7.</b>
                        
                        Add/Remove User and Query Capability interfaces
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.8" data-path="topics/user-storage/augmenting.html">
            
                
                    <a href="../../topics/user-storage/augmenting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.8.</b>
                        
                        Augmenting External Storage
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.9" data-path="topics/user-storage/import.html">
            
                
                    <a href="../../topics/user-storage/import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.9.</b>
                        
                        Import Implementation Strategy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.10" data-path="topics/user-storage/cache.html">
            
                
                    <a href="../../topics/user-storage/cache.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.10.</b>
                        
                        User Caches
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.11" data-path="topics/user-storage/javaee.html">
            
                
                    <a href="../../topics/user-storage/javaee.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.11.</b>
                        
                        Leveraging Java EE
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.12" data-path="topics/user-storage/rest.html">
            
                
                    <a href="../../topics/user-storage/rest.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.12.</b>
                        
                        REST Management API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.13" data-path="topics/user-storage/migration.html">
            
                
                    <a href="../../topics/user-storage/migration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.13.</b>
                        
                        Migrating from an Earlier User Federation SPI
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Server Developer Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <div class="sect2">
<h3 id="_model_interfaces">Model Interfaces</h3>
<div class="paragraph">
<p>Most of the methods defined in the <em>capability</em> <em>interfaces</em> either return or are passed in representations of a user.  These representations are defined
by the <code>org.keycloak.models.UserModel</code> interface.  App developers are required to implement this interface.  It provides
 a mapping between the external user store and the user metamodel that Keycloak uses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">package</span> org.keycloak.models;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserModel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RoleMapperModel</span> </span>{
    <span class="hljs-function">String <span class="hljs-title">getId</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function">String <span class="hljs-title">getUsername</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setUsername</span><span class="hljs-params">(String username)</span></span>;

    <span class="hljs-function">String <span class="hljs-title">getFirstName</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFirstName</span><span class="hljs-params">(String firstName)</span></span>;

    <span class="hljs-function">String <span class="hljs-title">getLastName</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setLastName</span><span class="hljs-params">(String lastName)</span></span>;

    <span class="hljs-function">String <span class="hljs-title">getEmail</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setEmail</span><span class="hljs-params">(String email)</span></span>;
...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>UserModel</code> implementations provide access to read and update metadata about the user including things like username, name, email,
role and group mappings, as well as other arbitrary attributes.</p>
</div>
<div class="paragraph">
<p>There are other model classes within the <code>org.keycloak.models</code> package the represent other parts of the Keycloak
metamodel:  <code>RealmModel</code>, <code>RoleModel</code>, <code>GroupModel</code>, and <code>ClientModel</code>.</p>
</div>
<div class="sect3">
<h4 id="_storage_ids">Storage Ids</h4>
<div class="paragraph">
<p>One really import method of <code>UserModel</code> is the <code>getId()</code> method.  When implementing <code>UserModel</code> developers must be aware
of the user id format.  The format must be</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&quot;f:&quot; + component id + &quot;:&quot; + external id</pre>
</div>
</div>
<div class="paragraph">
<p>The Keycloak runtime often has to lookup users by their user id.  The user id contains enough information
so that the runtime does not have to query every single <code>UserStorageProvider</code> in the system to find the user.</p>
</div>
<div class="paragraph">
<p>The component id is the id returned from <code>ComponentModel.getId()</code>.  The <code>ComponentModel</code> is passed in as a parameter
when creating the provider class so you can get it from there.  The external id is information your provider class
needs to find the user in the external store.  This is often a username or a uid.  For example, it might look something
like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>f:332a234e31234:wburke</pre>
</div>
</div>
<div class="paragraph">
<p>When the runtime does a lookup by id, the id is parsed to obtain the component id.  The component id is used to
locate the <code>UserStorageProvider</code> that was originally used to load the user.  That provider is then passed the id.
The provider again parses the id to obtain the external id it will use to locate the user in external user storage.</p>
</div>
</div>
</div>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../topics/user-storage/provider-capability-interfaces.html" class="navigation navigation-prev " aria-label="Previous page: Provider Capability Interfaces"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../topics/user-storage/packaging.html" class="navigation navigation-next " aria-label="Next page: Packaging and Deployment"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-ungrey/ungrey.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-splitter/splitter.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"toggle-chapters":{},"ungrey":{},"splitter":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
    </body>
    <!-- End of book Server Developer Guide -->
</html>
