
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Keycloak - Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Keycloak is an open source identity and access management solution">
    <meta name="author" content="Keycloak Team">
    <meta name="keywords" content="sso,idm,openid connect,saml,kerberos,ldap">

    <link href="resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="resources/css/prettify.css" rel="stylesheet">
    <link href="resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="resources/css/keycloak.css" rel="stylesheet">
    <link href="resources/css/tabzilla.css" rel="stylesheet">

    <!--[if lt IE 9]>
    <script src="resources/js/html5shiv.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="resources/favicon.ico">

    <script src="resources/js/jquery-1.11.1.min.js"></script>
    <script src="resources/js/bootstrap.min.js"></script>
    <script src="resources/js/prettify.js"></script>
    <script src="resources/js/jbossorg-tabzilla.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-79404298-1', 'auto');
        ga('send', 'pageview');

    </script>
    <script id="dpal" src="//www.redhat.com/dtm.js" type="text/javascript"></script>
</head>
<body onload="prettyPrint()">
<div id="wrap">

<div class="dropup">
    <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
    <script>
        window.addEventListener('load', function() {
            renderTabzilla("Keycloak", "http://www.keycloak.org", true );
        }, false);
    </script>
</div><header class="main-header">
    <div class="container">
        <div class="row">
            <div class="col-md-3 col-sm-3 col-xs-12 keycloak-logo-div navbar-header">
                <button type="button" class=" pull-right  navbar-toggle collapsed" data-toggle="collapse" data-target="#mainBtnTarget" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="index.html" title="Keycloak" class="keycloak-logo-a">
                    <img class="keycloak-logo" src="resources/images/keycloak_logo_480x108.png" border="0" alt="Keycloak"/>
                </a>
            </div>
            <div id="mainBtnTarget" class="col-md-9 col-sm-9 col-xs-12 collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="about.html">About</a></li>
                    <li><a href="documentation.html">Docs</a></li>
                    <li><a href="downloads.html">Downloads</a></li>
                    <li><a href="community.html">Community</a></li>
                    <li><a href="security.html">Security</a></li>
                    <li><a href="support.html">Support</a></li>
                    <li><a href="search.html">Search</a></li>
                    <li><a href="blog.html">Blog</a></li>
                </ul>
            </div>
        </div>
    </div>
</header>

<div class="page-section">
    <div class="container">
                <h1><a href="2019/01/keycloak-483final-released.html">Keycloak 4.8.3.Final released</a></h1>

                <p class="blog-date">Tuesday, January 15 2019</p>

                <div class="blog blog-container">
<p>To download the release go to <a href="https://www.keycloak.org/downloads.html">Keycloak downloads</a>.</p>

<p>
    For details on what is included in the release check out the <a href="https://www.keycloak.org/docs/latest/release_notes/index.html">Release notes</a>.
    The full list of resolved issues are available in <a href="https://issues.jboss.org/issues/?jql=project%20%3D%20keycloak%20and%20fixVersion%20%3D%204.8.3.Final">JIRA</a>
</p>

<p>Before you upgrade remember to backup your database and check the <a href="https://www.keycloak.org/docs/latest/upgrading/index.html">upgrade guide</a> for anything that may have changed.</p>                </div>














                <h1><a href="2018/06/keycloak-on-kubernetes.html">Keycloak on Kubernetes</a></h1>

                <p class="blog-date">Wednesday, June 27 2018, posted by Stian Thorgersen</p>

                <div class="blog blog-container">

<p>
If you'd like to get started with using Keycloak on Kubernetes check out <a href="https://youtu.be/A_BYZ7hHWXE">this screencast</a>.
If you'd rather try it out yourself check out <a href="https://github.com/stianst/demo-kubernetes">this GitHub repository</a> that contains the instructions as well as all the bits you'll need to reproduce what is shown in the screencast.
</p>                </div>



                <h1><a href="2018/06/keycloak-cordova-browser-tabs-support.html">Keycloak Cordova Browser Tabs support</a></h1>

                <p class="blog-date">Thursday, June 21 2018, posted by Stian Thorgersen</p>

                <div class="blog blog-container">

<p>
Thanks to <a href="https://github.com/gtudan">gtudan</a> we finally have support for browser tabs for Cordova in our JavaScript adapter. This enables using a system browser tab to do the login flows to Keycloak, which brings better security and also single sign-on and single sign-out to mobile applications secured with Keycloak.
</p>

<p>
This will be included in Keycloak 4.1.0.Final which will be released soon. In the meantime check this <a href="https://youtu.be/HKulxXDYJSs">screen-cast</a> to see this in action!
</p>                </div>



                <h1><a href="2018/06/red-hat-single-sign-on-in-keynote-demo-on-red-hat-summit.html">Red Hat Single Sign-On in Keynote demo on Red Hat Summit!</a></h1>

                <p class="blog-date">Sunday, June 17 2018, posted by Marek Posolda</p>

                <div class="blog blog-container">

<p>Red Hat Summit is one of the most important events during the year. Many geeks, Red Hat employees and customers have great opportunity to meet, learn new things and attend lots of interesting presentations and trainings. During the summit this year, there were few breakout sessions, which were solely about Keycloak and Red Hat SSO. You can take a look at <a href="http://blog.keycloak.org/2018/05/red-hat-single-sign-on-red-hat-summit.html">this blogpost</a> for more details.

<p>One of the most important parts of Red Hat Summit are Keynote demos, which show the main bullet points and strategies going forward. Typically they also contain the demos of the most interesting technologies, which Red Hat uses.

<p>On the Thursday morning keynote, there was <a href="https://www.youtube.com/watch?v=hu2BmE1Wk_Q&feature=youtu.be&t=385">this demo</a> to show the Hybrid Cloud with 3 clouds (Azure, Amazon, Private) in action! There were many technologies and interesting projects involved. Among others, let's name <a href="https://www.redhat.com/en/technologies/jboss-middleware/data-grid">Red Hat JBoss Data Grid (JDG)</a>, <a href="https://openwhisk.apache.org/">OpenWhisk</a> or <a href="https://www.gluster.org/">Gluster FS</a>. The <a href="https://access.redhat.com/products/red-hat-single-sign-on">RH-SSO</a> (Red Hat product based on Keycloak project) had a honor to be used as well.

<h2>Red Hat SSO setup details</h2>

<p>The frontend of the demo was the simple mobile game. RH-SSO was used at the very first stage to authenticate users to the mobile game. Each attendee had an opportunity to try it by yourself. In total, we had 1200 players of the game.

<p>There was loadbalancer up-front and every user was automatically forwarded to one of the 3 clouds. The mobile application used <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/securing_applications_and_services_guide/openid_connect_3#javascript_adapter">RH-SSO Javascript adapter</a> (keycloak.js) to communicate with RH-SSO.

<p>With Javascript application, whole OpenID Connect login flow happens within browser and hence can rely on sticky session. So since Javascript adapter is used, you may think that we can do just "easy" setup and let the RH-SSO instances across all 3 clouds to be independent of each other and have each of them to use separate RDBMS and infinispan caches. See the image below  for what such a setup would look like:

<img src="https://www.keycloak.org/resources/images/blog/cross-dc-blog-architecture-rhsso.png" />

<p>With this setup, every cloud is aware just about the users and sessions created on itself. This is fine with sticky session, but it won’t work for failover scenarios in case if one of the 3 clouds is broken/removed. There are also other issues with it - for example that admins and users see just sessions created on particular cloud. There are also potential security issues. For example when admin disables user on one cloud, user would still be enabled on other clouds as changes to user won’t be propagated to other clouds.

<p>So we rather want to show more proper setup aware of the replication. Also because one part of the demo was showing failover in action. One of the 3 clouds (Amazon) was killed and users, who were previously logged in Amazon, were redirected to one of the remaining 2 clouds. The point was that the end user won't be able to recognize any change. Hence users previously logged in Amazon must be still able to refresh their tokens in Azure or Private cloud. This in turn meant that the data (both users, user sessions and caches) need to be aware of all 3 clouds.

<p>In Keycloak 3.X, we added support for <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/server_installation_and_configuration_guide/operating-mode#crossdc-mode">Cross-datacenter (Cross-site) setup</a> with usage of external JDG servers to replicate data among datacenters (tech preview in RH-SSO 7.2). The demo was using exactly this setup. Each site had JDG server and all 3 sites communicate with each other through those JDG servers. This is standard JDG Cross-DC setup. See the picture below for what the demo looked like:

<img src="https://www.keycloak.org/resources/images/blog/cross-dc-blog-actual-setup-architecture-rhsso.png" />

<p>The JDG servers were not used during the demo just for the purpose of the RH-SSO, but also for the purpose of other parts of the demo. The details are described in the <a href="https://developers.redhat.com/blog/2018/06/19/red-hat-data-grid-on-three-clouds/">JDG setup blog by  Sebastian Łaskawiec</a>. The JDG servers were setup with ASYNC backups, which was more effective and was completely fine for the purpose of the demo due the fact that mobile application was using keycloak.js adapter. See <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/server_installation_and_configuration_guide/operating-mode#backups">RH-SSO docs</a> for more details.

<h2>Red Hat SSO customizations</h2>

<p>The RH-SSO was using standard <a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_middleware_for_openshift/3/html/red_hat_single_sign-on_for_openshift/">RH-SSO openshift image</a> . For Cross-DC setup, we needed to do configuration changes as described in the <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/server_installation_and_configuration_guide/operating-mode#crossdc-mode">RHSSO documentation</a> . Also few other customizations were done.

<h3>JDG User Storage</h3>

<p>RH-SSO Cross-DC setup currently requires both replicated RDBMS and replicated JDG server. When preparing to demo, we figured that using the clustered RDBMS in OpenShift replicated across all 3 clouds, is not very straightforward thing to setup.

<p>Fortunately RH-SSO is highly customizable platform and among other things, it provides supported <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/server_administration_guide/user-storage-federation">User Storage SPI</a> , which allows customers to plug their own storage for RH-SSO users. So instead of setup of replicated RDBMS, we created custom JDG User Storage. So users of the example realm were saved inside JDG instead of the RDBMS Database.

<p>Lessons learned is, that we want to make the Keycloak/RH-SSO Cross-DC setup simpler for administrators. Hence we're considering removing the need for replicated RDBMS entirely and instead store all realms and users metadata within JDG. So just replicated JDG would be a requirement for Cross-DC setup.

<h3>Other customizations</h3>

<p>For the purpose of the demo, we did custom login theme. We also did Email-Only authenticator, which allows to register user just by providing their email address. This is obviously not very secure, but it's pretty neat for the example purpose. Keynote users were also able to login with <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html/server_administration_guide/identity_broker#google">Google Identity Provider</a>  or <a href="https://developers.redhat.com/">Red Hat Developers OpenID Connect Identity Provider</a>, which was useful for users, who already had an account in those services.

<img src="https://www.keycloak.org/resources/images/blog/login-screen.png" />

<p>If you want to try all these things in action, you can try to checkout our <a href="https://github.com/rhdemo/rh-sso">Demo Project on Github</a> and deploy it to your own openshift cluster! If you have 3 clouds, even better! You can try the full setup including JDG to try exactly the setup we used during keynote demo.








                </div>




                <h1><a href="2018/05/keycloak-on-openshift.html">Keycloak on OpenShift</a></h1>

                <p class="blog-date">Thursday, May 31 2018, posted by Stian Thorgersen</p>

                <div class="blog blog-container">


<p>
In this post you'll see how to deploy Keycloak on OpenShift. You'll also learn how to deploy a Node.js based REST service and an HTML5 application to OpenShift and secure these with Keycloak.
</p>

<p>
There is also a screencast showing this example at <a href="https://youtu.be/9zUWqbK3BqI">https://youtu.be/9zUWqbK3BqI</a>.
</p>

<p>
If you don't already have OpenShift available a good place to start is by using <a href="https://github.com/minishift/minishift">MiniShift</a>.

<h2>Deploying Keycloak</h2>

<p>
First of all create a new project in OpenShift with oc by running:
<pre>
oc new-project keycloak
</pre>
</p>

<p>
The next thing to do is to import the Keycloak template into OpenShift, by running:
<pre>
oc replace --force -f "https://raw.githubusercontent.com/jboss-dockerfiles/keycloak"\
"/master/openshift-examples/keycloak-https.json"
</pre>
</p>

<p>
Now open the OpenShift console and open the keycloak project.
</p>

<p>
Click on Add to Project and Browse Catalog. In the catalog you should find Keycloak. Click on it.
</p>

<p>
Click next on the information. Under configuration set a username and password that you can remember in the Keycloak Administrator Username and Keycloak Administrator Password fields. Then click on create. Click on Continue to project overview.
</p>

<p>
Wait for the deployment to complete then click on the link to the application. Your browser will complain about the certificate as it is a self-signed certificate. Ignore this and proceed. Click on Administration Console, then login with the username and password you entered previously. Keep this tab open as you will need it later.
</p>

<p>
You have now deployed Keycloak onto OpenShift.
</p>

<h2>Configure Clients in Keycloak</h2>

<p>
We need to create clients for the service and the application we will secure.
</p>

<p>
Open the tab with the Keycloak admin console. Click on Clients and Create. For Client ID enter service and click Save. Under Access Type select bearer-only and click on Save.
</p>

<p>
Click on Clients then Create again. For Client ID enter app and click Save. For Valid Redirect URIs and Web Origins enter *. In production environment it is very important that you enter the correct URL for your application, but since this is a demonstration we will simply allow all URLs for simplicity. You can easily update these to the correct URLs for the application after it has been deployed.
</p>

<p>
Keep the Keycloak admin console tab open as again you will need it later.
</p>

<h2>Deploy the Service</h2>

<p>
Go back to the tab with the OpenShift console and click on Add to Project and Browse Catalog again. This time click on Node.js. Click next on Information, then click on advanced options under Configuration.
</p>

<p>
Make the following changes:
<ul>
<li>Name: service</li>
<li>Git Repository URL: https://github.com/stianst/misc.git</li>
<li>Context Dir: openshift/service
<li>Secure route: enable
<li>TLS Termination: Edge
<li>Insecure Traffic: Redirect
<li>
Deployment Config
<ul><li>KEYCLOAK_URL=https://secure-keycloak-keycloak.192.168.42.52.nip.io/auth</li></ul>
</li>
</ul>

Replace the value for KEYCLOAK_URL with the URL for Keycloak. You can find this by going back to the tab with the Keycloak admin console (copy the URL up to and including "/auth").
</p>

<p>
Click on Create then Continue to the project overview. Wait for the build and deployment to complete then click on the link to the application. You should see "Not found!". Add "/service/public" to the url and you should see "message: public" in JSON.
</p>

<p>
You have now deployed and secured the service. Keep this tab open as well as you need it later.
</p>

<h2>Deploy the Application</h2>

<p>
Go back to the tab with the OpenShift console and click on Add to Project and Browse Catalog again. This time click on PHP. Click next on Information, then click on advanced options under Configuration.
</p>

<p>
Make the following changes:
<ul>
<li>Name: app</li>
<li>Git Repository URL: https://github.com/stianst/misc.git</li>
<li>Context Dir: openshift/app
<li>Secure route: enable
<li>TLS Termination: Edge
<li>Insecure Traffic: Redirect
<li>
Deployment Config
<ul><li>KEYCLOAK_URL=https://secure-keycloak-keycloak.192.168.42.52.nip.io/auth</li></ul>
<ul><li>SERVICE_URL=https://service-keycloak.192.168.42.240.nip.io/service</li></ul>
</li>
</ul>

Replace the value for KEYCLOAK_URL with the URL for Keycloak. You can find this by going back to the tab with the Keycloak admin console (copy the URL up to and including "/auth"). Also, replace the value for SERVICE_URL with the URL for the Service. You can find this by going back to the tab with the service (copy the URL up to and including "/service").
</p>

<p>
Click on Create then Continue to the project overview. Wait for the build and deployment to complete then click on the link to the application. You should already be logged-in. You can now invoke the service by clicking on Invoke Public to invoke the unsecured endpoint or Invoke Admin to invoke the endpoint secured with the admin role. If you click on Invoke Secured it will fail as the admin user you are logged in with does not have the user role. To be able to invoke this endpoint as well go back to the Keycloak admin console. Create a realm role named user. Then go to users find your admin user and under role mappings add the user role to the user.
</p>

<p>
You have now deployed and secured the application as well as seen how the application can securely invoke the service you deployed previously.
</p>                </div>




        <h3>For older entries go <a href="blog-archive.html">here</a>.</h3>
    </div>
</div>
		</div>
		<div id="push"></div>
    </div>

    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-sm-9 col-xs-12">
                    <a href="http://www.redhat.com/" target="_blank">
                        <img alt="redhatlogo-white" src="resources/images/redhatlogo-white.png" width="130">
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
            _satellite.pageBottom();
        }
    </script>
  </body>
</html>